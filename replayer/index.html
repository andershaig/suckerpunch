<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Suckerpunch Replayer</title>

  <style>
    * {
      margin:0;
      padding:0;
    }

    body {
      background:url(http://i.imgur.com/m6SQxHi.png) 0 0 no-repeat;
    }
  </style>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
  <script src="raphael-min.js"></script>
  <script>
    (function ($, Replayer, undefined) {
        // Creates a new canvas element and appends it as a child
        // to the parent element, and returns the reference to
        // the newly created canvas element

        Replayer.createCanvas = function (parent, width, height) {
            var canvas = {};
            canvas.node = document.createElement('canvas');
            canvas.context = canvas.node.getContext('2d');
            canvas.node.width = width || 100;
            canvas.node.height = height || 100;
            parent.appendChild(canvas.node);
            return canvas;
        }
        
        Replayer.drawLines = function (ctx, pdata) {
            ctx.beginPath();
            ctx.strokeStyle = "rgb(180,800,95)";
            
            // draw the stored lines
            for (var i = 0; i < pdata.length; i++) {
                ctx.moveTo(pdata[i].x, pdata[i].y);

                console.log(i);
                console.log(pdata.length);
                
                if (i < pdata.length - 1) {
                    ctx.lineTo(pdata[i+1].x, pdata[i+1].y);
                    ctx.stroke();
                }
            }
            
            //ctx.moveTo(mouse.x, mouse.y);
            //ctx.lineTo(k.pageX - parentOffset.left, k.pageY - parentOffset.top);
            //ctx.stroke();
            
            ctx.closePath();
        }

        Replayer.init = function (container, width, height, fillColor) {
            var canvas = Replayer.createCanvas(container, width, height);
            var ctx = canvas.context;
            
            // custom fillCircle method
            ctx.fillCircle = function(x, y, radius, fillColor) {
                this.fillStyle = fillColor;
                this.beginPath();
                this.moveTo(x, y);
                this.arc(x, y, radius, 0, Math.PI * 2, false);
                this.fill();
            };
            
            ctx.clearTo = function(fillColor) {
                ctx.fillStyle = fillColor;
                ctx.fillRect(0, 0, width, height);
            };
            
            ctx.clearTo(fillColor || "transparent");

            // bind mouse events
            var pdata = [
                {x: 1123,y: 95,t: 1371961141308},
                {x: 941,y: 76,t: 1371961141393},
                {x: 473,y: 231,t: 1371961141476},
                {x: 266,y: 326,t: 1371961141561},
                {x: 137,y: 402,t: 1371961141644},
                {x: 102,y: 433,t: 1371961141727}
            ];
      
        Replayer.drawLines(ctx, pdata);
        
        ctx.stroke();
            
            $.each(pdata, function (i, v) {
                console.log('Running ' + i);
                
                var x = v.x;
                var y = v.y;
                var innerRadius = 2;
                var outerRadius = 3;
                var innerColor = '#03F638';
                var outerColor = '#000';
                ctx.fillCircle(x, y, outerRadius, outerColor);
                ctx.fillCircle(x, y, innerRadius, innerColor);
            });
        }

        var container = document.getElementById('canvas');
        var width = window.innerWidth;
        var height = window.innerHeight;
        Replayer.init(container, width, height, 'transparent');

    }(jQuery, window.Replayer = window.Replayer || {}));
  </script>
</head>
<body>

<div id="canvas"></div>

</body>
</html>